<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Help.Bettermeans - Post-Receive Hooks</title>
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen" charset="utf-8"/>
    <link rel="stylesheet" href="/css/print.css" type="text/css" media="print">
  </head>

  <body>
    
      
        <script type="text/javascript">var main_category = "collaborating"</script>
      
    
    <div id="main">
      <div id="header" class="basic">
        <div class="site">
          <div class="logo boring">
            <a href="/"><img src="/images/help.github.png" alt="bettermeans learn logo" /></a>
          </div>
          <div class="topsearch">
            <ul class="nav logged_out">
              <!-- <li><a href="http://gitref.org/">Git Reference</a></li>
              <li><a href="http://bettermeans.com/bettermeans/help.bettermeans.com#readme">Contribute</a></li>
              <li><a href="http://support.bettermeans.com/">Support</a></li> -->
              <li><a href="http://bettermeans.com/">Back to Bettermeans</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div id="content" class="site">
        <div id="guides">
          <div class="guide">
            <div class="main">
              <h1>Post-Receive Hooks</h1>

              <div class="wikistyle">
                <p><em>For help testing webhooks, see <a href='/testing-webhooks'>this guide</a></em></p>

<p>If you supply a post-receive URL, GitHub will POST to that URL when someone uses <code>git push</code> on that repository.</p>

<p><img src='http://img.skitch.com/20100620-r8st7468q7q5waf3y85hmpwtqs.png' alt='' /></p>

<p><img src='http://img.skitch.com/20100620-br6dw5iiyk2643fahkqbi54h36.png' alt='' /></p>

<p>What we&#8217;ll send is JSON containing information about the push and the commits involved.</p>

<p>Here&#8217;s the template we use in Ruby to generate the JSON:</p>
<div>
  <pre>
    <code class='ruby'>{
  :before     =&gt; before,
  :after      =&gt; after,
  :ref        =&gt; ref,
  :commits    =&gt; [{
    :id        =&gt; commit.id,
    :message   =&gt; commit.message,
    :timestamp =&gt; commit.committed_date.xmlschema,
    :url       =&gt; commit_url,
    :added     =&gt; array_of_added_paths,
    :removed   =&gt; array_of_removed_paths,
    :modified  =&gt; array_of_modified_paths,
    :author    =&gt; {
      :name  =&gt; commit.author.name,
      :email =&gt; commit.author.email
    }
  }],
  :repository =&gt; {
    :name        =&gt; repository.name,
    :url         =&gt; repo_url,
    :pledgie     =&gt; repository.pledgie.id,
    :description =&gt; repository.description,
    :homepage    =&gt; repository.homepage,
    :watchers    =&gt; repository.watchers.size,
    :forks       =&gt; repository.forks.size,
    :private     =&gt; repository.private?,
    :owner =&gt; {
      :name  =&gt; repository.owner.login,
      :email =&gt; repository.owner.email
    }
  }
}</code>
  </pre>
</div>
<p>This is sent as a POST with a single parameter: &#8216;payload&#8217;</p>

<p>So, for example, you&#8217;d do something like this in a <a href='http://sinatra.rubyforge.org/'>Sinatra</a> server:</p>
<div>
  <pre>
    <code class='ruby'>post '/' do
  push = JSON.parse(params[:payload])
  &quot;I got some JSON: #{push.inspect}&quot;
end</code>
  </pre>
</div>
<p>The <code>commits</code> array is ordered with the most recent commit as the first element. The last element, therefor, is the oldest commit.</p>

<p>Here&#8217;s an example payload:</p>
<div>
  <pre>
    <code class='javascript'>{
  &quot;before&quot;: &quot;5aef35982fb2d34e9d9d4502f6ede1072793222d&quot;,
  &quot;repository&quot;: {
    &quot;url&quot;: &quot;http://github.com/defunkt/github&quot;,
    &quot;name&quot;: &quot;github&quot;,
    &quot;description&quot;: &quot;You're lookin' at it.&quot;,
    &quot;watchers&quot;: 5,
    &quot;forks&quot;: 2,
    &quot;private&quot;: 1,
    &quot;owner&quot;: {
      &quot;email&quot;: &quot;chris@ozmm.org&quot;,
      &quot;name&quot;: &quot;defunkt&quot;
    }
  },
  &quot;commits&quot;: [
    {
      &quot;id&quot;: &quot;41a212ee83ca127e3c8cf465891ab7216a705f59&quot;,
      &quot;url&quot;: &quot;http://github.com/defunkt/github/commit/41a212ee83ca127e3c8cf465891ab7216a705f59&quot;,
      &quot;author&quot;: {
        &quot;email&quot;: &quot;chris@ozmm.org&quot;,
        &quot;name&quot;: &quot;Chris Wanstrath&quot;
      },
      &quot;message&quot;: &quot;okay i give in&quot;,
      &quot;timestamp&quot;: &quot;2008-02-15T14:57:17-08:00&quot;,
      &quot;added&quot;: [&quot;filepath.rb&quot;]
    },
    {
      &quot;id&quot;: &quot;de8251ff97ee194a289832576287d6f8ad74e3d0&quot;,
      &quot;url&quot;: &quot;http://github.com/defunkt/github/commit/de8251ff97ee194a289832576287d6f8ad74e3d0&quot;,
      &quot;author&quot;: {
        &quot;email&quot;: &quot;chris@ozmm.org&quot;,
        &quot;name&quot;: &quot;Chris Wanstrath&quot;
      },
      &quot;message&quot;: &quot;update pricing a tad&quot;,
      &quot;timestamp&quot;: &quot;2008-02-15T14:36:34-08:00&quot;
    }
  ],
  &quot;after&quot;: &quot;de8251ff97ee194a289832576287d6f8ad74e3d0&quot;,
  &quot;ref&quot;: &quot;refs/heads/master&quot;
}</code>
  </pre>
</div>
<p>For more information on this technique, see the <a href='http://webhooks.pbwiki.com/'>Web Hooks Wiki</a>.</p>

<h2 id='links'>Links</h2>

<ul>
<li><a href='http://github.com/raggi/github_post_receive_server/'>raggi/github_post_receive_server</a> &#8211; A template Rack server</li>

<li><a href='http://github.com/jnewland/github-campfire/'>jnewland/github-campfire</a></li>

<li><a href='http://github.com/webs/irccat'>webs/irccat</a></li>

<li><a href='http://github.com/jnunemaker/github-twitter/'>jnunemaker/github-twitter</a></li>
</ul>
              </div>
            </div>

            <div class="sidebar">
              
                <h3>Getting started</h3>
                  <ul id="categories">
                    
                  </ul>
              
                <h3>Guides</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/voting" id="guides">Dashboard</a></li>
                      
                    
                  </ul>
              
                <h3>Faq</h3>
                  <ul id="categories">
                    
                  </ul>
              
                <h3>Popular</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/forking" id="popular">Forking a project</a></li>
                      
                    
                      
                        <li><a href="/key-setup-redirect" id="popular">Generating SSH keys</a></li>
                      
                    
                      
                        <li><a href="/troubleshooting-common-issues" id="popular">Common issues and questions</a></li>
                      
                    
                      
                        <li><a href="/troubleshooting-ssh" id="popular">Troubleshooting SSH issues</a></li>
                      
                    
                      
                        <li><a href="/git-email-settings" id="popular">Setting user name, email and GitHub token</a></li>
                      
                    
                      
                        <li><a href="/removing-sensitive-data" id="popular">Removing sensitive data</a></li>
                      
                    
                      
                        <li><a href="/voting" id="popular">Dashboard</a></li>
                      
                    
                  </ul>
              
            </div>
          </div>
        </div>
      </div>
      <div class="push"></div>
    </div>

    <div id="footer">
      <div class="site">

        <div class="info">
          <div class="links">
            <a href="http://bettermeans.org/front/?cat=3"><b>Blog</b></a> |
            <a href="http://bettermeans.org/front/?page_id=284">Contact</a> |
            <a href="http://twitter.com/bettermeans">Twitter</a> |
            <a href="http://bettermeans.com/front/user_agreement.html">Terms of Service</a> | 
            <a href="http://bettermeans.com/front/privacy.html">Privacy Policy</a>
          </div>
          <div class="company">
           &copy;&copy;
            2010
            Bettermeans LLC.
            <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/us/" rel="license">
            Creative Commons Attribution-Noncommercial-Share Alike 3.0 License</a>
           
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
