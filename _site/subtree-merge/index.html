<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Help.Bettermeans - Working with subtree merge</title>
    <link href="http://bettermeans.com/stylesheets/bundle_common.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="http://bettermeans.com/stylesheets/bundle_bettermeans.css" media="screen" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen" charset="utf-8"/>
    <link rel="stylesheet" href="/css/print.css" type="text/css" media="print">
  </head>

  <body>
    
      
        <script type="text/javascript">var main_category = "git_ninjutsu"</script>
      
    
    <div id="main">
      <div id="header" class="basic">
        <div class="site">
          <div class="logo boring">
            <a href="/"><img src="/images/help.bettermeans.png" alt="bettermeans learn logo" /></a>
          </div>
          <div class="topsearch">
            <ul class="nav logged_out">
              <li><a href="http://gitref.org/">Git Reference</a></li>
              <li><a href="http://bettermeans.com/bettermeans/help.bettermeans.com#readme">Contribute</a></li>
              <li><a href="http://support.bettermeans.com/">Support</a></li>
              <li><a href="http://bettermeans.com/">Back to Bettermeans</a></li>
            </ul>
          </div>
        </div>
      </div>

      <div id="content" class="site">
        <div id="guides">
          <div class="guide">
            <div class="main">
              <h1>Working with subtree merge</h1>

              <div class="wikistyle">
                <p>There are times when submodules are not adequate for the task at hand. For example, blending multiple repos together into one single repo while still maintaining the history of each repo. To do this, the subtree merge strategy is a better solution.</p>

<h2 id='setting_up_and_doing_the_first_merge'>Setting up and doing the first merge</h2>

<p>For this example, we&#8217;ll make an empty &#8220;parent&#8221; repo and some other repos into it as subpaths.</p>

<p>First, set up an empty repo for our example:</p>

<pre><code>[tekkub@tekBook: ~/tmp master*]
$ mkdir test

[tekkub@tekBook: ~/tmp master*]
$ cd test

[tekkub@tekBook: ~/tmp/test master*]
$ git init
Initialized empty Git repository in /Users/tekkub/tmp/test/.git/

[tekkub@tekBook: ~/tmp/test master#]
$ touch .gitignore

[tekkub@tekBook: ~/tmp/test master#]
$ git add .gitignore

[tekkub@tekBook: ~/tmp/test master#]
$ git commit -m &quot;initial commit&quot;
[master (root-commit) 3146c2a] initial commit
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 .gitignore</code></pre>

<p>Now we&#8217;ll subtree-merge the repo <a href='https://github.com/tekkub/cork'>tekkub/cork</a> into the repo at <code>cork/</code></p>

<pre><code>[tekkub@tekBook: ~/tmp/test master]
$ git remote add -f cork git://github.com/tekkub/cork.git
Updating cork
warning: no common commits
remote: Counting objects: 1732, done.
remote: Compressing objects: 100% (750/750), done.
remote: Total 1732 (delta 1086), reused 1558 (delta 967)
Receiving objects: 100% (1732/1732), 528.19 KiB | 621 KiB/s, done.
Resolving deltas: 100% (1086/1086), done.
From git://github.com/tekkub/cork
 * [new branch]      lastbuffed -&gt; cork/lastbuffed
 * [new branch]      lock_n_mount -&gt; cork/lock_n_mount
 * [new branch]      master     -&gt; cork/master
 * [new branch]      nothing_to_see_here -&gt; cork/nothing_to_see_here

[tekkub@tekBook: ~/tmp/test master]
$ git merge -s ours --no-commit cork/master
Automatic merge went well; stopped before committing as requested

[tekkub@tekBook: ~/tmp/test master|MERGING]
$ git read-tree --prefix=cork/ -u cork/master

[tekkub@tekBook: ~/tmp/test master+|MERGING]
$ git commit -m &quot;Subtree merged in cork&quot;
[master fe0ca25] Subtree merged in cork</code></pre>

<p>Next, we&#8217;ll merge in <a href='https://github.com/tekkub/panda'>tekkub/panda</a> into the path <code>panda/</code></p>

<pre><code>[tekkub@tekBook: ~/tmp/test master]
$ git remote add -f panda git://github.com/tekkub/panda.git
Updating panda
warning: no common commits
remote: Counting objects: 974, done.
remote: Compressing objects: 100% (722/722), done.
remote: Total 974 (delta 616), reused 399 (delta 251)
Receiving objects: 100% (974/974), 189.56 KiB, done.
Resolving deltas: 100% (616/616), done.
From git://github.com/tekkub/panda
 * [new branch]      master     -&gt; panda/master
 * [new branch]      transmute  -&gt; panda/transmute

[tekkub@tekBook: ~/tmp/test master]
$ git merge -s ours --no-commit panda/master
Automatic merge went well; stopped before committing as requested

[tekkub@tekBook: ~/tmp/test master|MERGING]
$ git read-tree --prefix=panda/ -u panda/master

[tekkub@tekBook: ~/tmp/test master+|MERGING]
$ git commit -m &quot;Subtree merged in panda&quot;
[master 726a2cd] Subtree merged in panda</code></pre>

<p>Finally, we&#8217;re going to merge the subpath <code>modules/</code> from tekkub/cork into <code>cork2/</code></p>

<pre><code>tekkub@iSenberg ~/tmp/test master
$ git merge -s ours --no-commit cork/master
Automatic merge went well; stopped before committing as requested

tekkub@iSenberg ~/tmp/test master|MERGING
$ git read-tree --prefix=cork2/ -u cork/master:modules

tekkub@iSenberg ~/tmp/test master+|MERGING
$ git commit -m &quot;Subtree merged in cork/modules&quot;
[master f240057] Subtree merged in cork/modules</code></pre>

<h2 id='pulling_in_changes'>Pulling in changes</h2>

<p>If the merged repo changes in the future, you can pull in its changes by simply using the <code>-s subtree</code> flag:</p>

<pre><code>[tekkub@tekBook: ~/tmp/test master]
$ git pull -s subtree panda master</code></pre>

<h2 id='resources'>Resources</h2>

<ul>
<li><a href='http://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html'>How to use the subtree merge strategy</a></li>
</ul>
              </div>
            </div>

            <div class="sidebar">
              
                <h3>Setup</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/git-installation-redirect" id="setup">Installing git</a></li>
                      
                    
                      
                        <li><a href="/key-setup-redirect" id="setup">Generating SSH keys</a></li>
                      
                    
                      
                        <li><a href="/troubleshooting-ssh" id="setup">Troubleshooting SSH issues</a></li>
                      
                    
                      
                        <li><a href="/git-email-settings" id="setup">Setting user name, email and GitHub token</a></li>
                      
                    
                      
                        <li><a href="/working-with-key-passphrases" id="setup">Working with SSH key passphrases</a></li>
                      
                    
                      
                        <li><a href="/dealing-with-lineendings" id="setup">Dealing with line endings</a></li>
                      
                    
                      
                        <li><a href="/managing-clients" id="setup">Managing multiple clients</a></li>
                      
                    
                      
                        <li><a href="/svn-importing" id="setup">Importing from Subversion</a></li>
                      
                    
                  </ul>
              
                <h3>Troubleshooting</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/troubleshooting-common-issues" id="troubleshooting">Common issues and questions</a></li>
                      
                    
                      
                        <li><a href="/troubleshooting-ssh" id="troubleshooting">Troubleshooting SSH issues</a></li>
                      
                    
                      
                        <li><a href="/egit-corruption" id="troubleshooting">Fixing egit corruption</a></li>
                      
                    
                      
                        <li><a href="/testing-webhooks" id="troubleshooting">Testing webhooks</a></li>
                      
                    
                      
                        <li><a href="/firewalls-and-proxies" id="troubleshooting">Dealing with firewalls and proxies</a></li>
                      
                    
                  </ul>
              
                <h3>Repos</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/creating-a-repo" id="repos">Creating a repo</a></li>
                      
                    
                      
                        <li><a href="/deleting-a-repo" id="repos">Deleting a repo</a></li>
                      
                    
                      
                        <li><a href="/moving-a-repo" id="repos">Moving a repo</a></li>
                      
                    
                  </ul>
              
                <h3>Collaborating</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/forking" id="collaborating">Forking a project</a></li>
                      
                    
                      
                        <li><a href="/post-receive-hooks" id="collaborating">Post-Receive Hooks</a></li>
                      
                    
                      
                        <li><a href="/testing-webhooks" id="collaborating">Testing webhooks</a></li>
                      
                    
                      
                        <li><a href="/managing-clients" id="collaborating">Managing multiple clients</a></li>
                      
                    
                      
                        <li><a href="/pull-requests" id="collaborating">Sending pull requests</a></li>
                      
                    
                  </ul>
              
                <h3>Everyday git</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/remotes" id="everyday_git">Working with remotes</a></li>
                      
                    
                      
                        <li><a href="/git-ignore" id="everyday_git">Ignoring files</a></li>
                      
                    
                      
                        <li><a href="/rebase" id="everyday_git">All your rebase</a></li>
                      
                    
                      
                        <li><a href="/git-cheat-sheets" id="everyday_git">Git cheat sheets</a></li>
                      
                    
                  </ul>
              
                <h3>Git ninjutsu</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/removing-sensitive-data" id="git_ninjutsu">Removing sensitive data</a></li>
                      
                    
                      
                        <li><a href="/splitting-a-subpath-to-a-new-repo" id="git_ninjutsu">Splitting a subpath out into a new repo</a></li>
                      
                    
                      
                        <li>Working with subtree merge</li>
                      
                    
                      
                        <li><a href="/changing-author-info" id="git_ninjutsu">Changing author info</a></li>
                      
                    
                  </ul>
              
                <h3>Deploying</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/deploy-keys" id="deploying">Understanding deploy keys</a></li>
                      
                    
                      
                        <li><a href="/capistrano" id="deploying">Deploying with Capistrano</a></li>
                      
                    
                  </ul>
              
                <h3>Mac</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/mac-git-installation" id="mac">Installing git (OSX)</a></li>
                      
                    
                      
                        <li><a href="/mac-key-setup" id="mac">Generating SSH keys (OSX)</a></li>
                      
                    
                      
                        <li><a href="/working-with-key-passphrases" id="mac">Working with SSH key passphrases</a></li>
                      
                    
                      
                        <li><a href="/dealing-with-lineendings" id="mac">Dealing with line endings</a></li>
                      
                    
                      
                        <li><a href="/textmate" id="mac">Textmate</a></li>
                      
                    
                  </ul>
              
                <h3>Windows</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/win-git-installation" id="windows">Installing git (Win/msysgit)</a></li>
                      
                    
                      
                        <li><a href="/msysgit-key-setup" id="windows">Generating SSH keys (Win/msysgit)</a></li>
                      
                    
                      
                        <li><a href="/working-with-key-passphrases" id="windows">Working with SSH key passphrases</a></li>
                      
                    
                      
                        <li><a href="/dealing-with-lineendings" id="windows">Dealing with line endings</a></li>
                      
                    
                  </ul>
              
                <h3>Linux</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/linux-git-installation" id="linux">Installing git (Linux)</a></li>
                      
                    
                      
                        <li><a href="/linux-key-setup" id="linux">Generating SSH keys (Linux)</a></li>
                      
                    
                      
                        <li><a href="/dealing-with-lineendings" id="linux">Dealing with line endings</a></li>
                      
                    
                  </ul>
              
                <h3>Other</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/git-html-help" id="other">Installing Git HTML help</a></li>
                      
                    
                      
                        <li><a href="/userscripts-and-bookmarklets" id="other">Userscripts and Bookmarklets</a></li>
                      
                    
                      
                        <li><a href="/api" id="other">GitHub API</a></li>
                      
                    
                      
                        <li><a href="/multiple-keys" id="other">Multiple SSH keys</a></li>
                      
                    
                  </ul>
              
                <h3>Site policy</h3>
                  <ul id="categories">
                    
                      
                        <li><a href="/security" id="site_policy">GitHub Security</a></li>
                      
                    
                      
                        <li><a href="/privacy" id="site_policy">GitHub Privacy Policy</a></li>
                      
                    
                      
                        <li><a href="/terms" id="site_policy">GitHub Terms of Service</a></li>
                      
                    
                      
                        <li><a href="/dmca" id="site_policy">DMCA Takedown</a></li>
                      
                    
                  </ul>
              
            </div>
          </div>
        </div>
      </div>
      <div class="push"></div>
    </div>

    <div id="footer">
      <div class="site">

        <div class="info">
          <div class="links">
            <a href="http://bettermeans.com/blog"><b>Blog</b></a> |
            <a href="http://support.bettermeans.com/">Support</a> |
            <a href="http://bettermeans.com/training">Training</a> |
            <a href="http://bettermeans.com/contact">Contact</a> |
            <a href="http://develop.bettermeans.com">API</a> |
            <a href="http://status.bettermeans.com">Status</a> |
            <a href="http://twitter.com/bettermeans">Twitter</a> |
            <a href="http://gitref.org">Learn</a> |
            <a href="http://bettermeans.com/security">Security</a>
          </div>
          <div class="company">
           &copy;
            2010
            Bettermeans LLC.
            All rights reserved.
           | <a href="http://bettermeans.com/site/terms">Terms of Service</a> | <a href="http://bettermeans.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
